<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<script th:src="@{https://unpkg.com/axios/dist/axios.min.js}"></script>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Post</title>
  <link rel="stylesheet" href="https://unpkg.com/mvp.css@1.12/mvp.css">
</head>


<body>

<div>
    <div>
        <h1>사용자 구내내역</h1>
    </div>
    <section>
        <ul class="posts"></ul>
    </section>
    <div></div>
</div>

<script>
    const tbody = document.querySelector('.posts');

    document.addEventListener("DOMContentLoaded", function () {

        const id = [[${id}]];

        axios.get(`/api/v1/purchased/${id}`)
            .then(response => {
                response.data.responseList.map(post => addRow(post));

              })
            .catch(error => {
                alert("오류가 발생했습니다. \n" + error);
                console.error(error);
            });
    });

    function addRow(post) {
        let item2 = '';
        for (let imageKey of post.images) {
            item2 +=
                    `
                    <div>
                      <img src="../../${imageKey.path}" alt="이미지", style="width: 120px; height: 120px">
                    </div>
                    `
        }
        
        const item =
                `
              <div style="margin-bottom: 100px">
                <div>
                  <div>제목 : ${post.title}</div>
                </div>
                <div>
                  <div>카테고리 : ${post.category}</div>
                </div>
                <div>
                  <div>상태 : ${post.status}</div>
                </div>
                <div>
                  <div>가격 : ${post.price}</div>
                </div>
                <div>
                  <div>조회수 : ${post.views}</div>
                </div>
              </div>
                `
        tbody.innerHTML += item2;
        tbody.innerHTML += item;
    }

</script>

</body>
</html>
